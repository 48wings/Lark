var __extends=this.__extends||function(i,t){function o(){this.constructor=i}for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);o.prototype=t.prototype,i.prototype=new o},__define=this.__define||function(i,t,o,n){Object.defineProperty(i,t,{configurable:!0,enumerable:!0,get:o,set:n})},lark;!function(i){var t;!function(t){var o=function(o){function n(i){o.call(this),this.audios=[],this.loaded=!1,this.closed=!1,this.url=i}__extends(n,o);var e=n;return p=e.prototype,p.load=function(i){var t=this;i=i||this.url;var o=new Audio(i);o.addEventListener("canplaythrough",function(){return t.onAudioLoaded()}),o.addEventListener("error",function(){return t.onAudioError()}),o.load(),this.originAudio=o,this.audios.push(o)},p.play=function(i,o){void 0===i&&(i=0),void 0===o&&(o=!1);var n=this.audios.pop();void 0==n?(n=this.originAudio.cloneNode(),n.addEventListener("canplaythrough",function(){return n.currentTime=i})):n.currentTime=i,n.loop=!!o;var e=new t.HtmlSoundChannel(n);return e.$sound=this,e.$loop=o,e.$startTime=i,n.play(),e},p.close=function(){0==this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),this.audios&&(this.audios.length=0),this.closed=!0},p.$recycle=function(i){this.closed||this.audios.push(i)},p.onAudioLoaded=function(){this.loaded=!0,this.emitWith(i.Event.COMPLETE)},p.onAudioError=function(){this.emitWith(i.Event.IO_ERROR)},n}(i.EventEmitter);t.HtmlSound=o,i.Sound=o}(t=i.web||(i.web={}))}(lark||(lark={}));var lark;!function(i){var t;!function(t){var o=function(t){function o(i){var o=this;t.call(this),this.$loop=!1,this.$startTime=0,this.audio=null,this.onPlayEnd=function(){return 0==o.$loop?void o.stop():(o.audio.load(),o.audio.currentTime=o.$startTime,void o.audio.play())},i.addEventListener("ended",this.onPlayEnd),this.audio=i}__extends(o,t);var n=__define,e=o;return p=e.prototype,p.stop=function(){if(this.audio){var t=this.audio;t.pause(),t.removeEventListener("ended",this.onPlayEnd),t.$channel=null,this.audio=null,this.emitWith(i.Event.ENDED),this.$sound.$recycle(t),this.$sound=null}},n(p,"volume",function(){return this.audio?this.audio.volume:1},function(i){this.audio&&(this.audio.volume=i)}),n(p,"position",function(){return this.audio?this.audio.currentTime:0},void 0),o}(i.EventEmitter);t.HtmlSoundChannel=o}(t=i.web||(i.web={}))}(lark||(lark={}));var lark;!function(i){var t;!function(t){var o=function(t){function o(i){t.call(this),this.loaded=!1,this.closed=!1,this.url=i}__extends(o,t);var n=__define,e=o;return p=e.prototype,p.load=function(i){var t=this;i=i||this.url;var o=document.createElement("video");o.src=i,o.addEventListener("canplay",function(){return t.onVideoLoaded()}),o.addEventListener("error",function(){return t.onVideoError()}),o.addEventListener("ended",function(){return t.onVideoEnded()}),o.load(),this.video=o},p.play=function(i,t){void 0===i&&(i=0),void 0===t&&(t=!1);var o=this.video;o.currentTime=i,o.loop=!!t,o.play()},p.close=function(){this.stop(),0==this.loaded&&this.video&&(this.video.src=""),this.video&&(this.video=null),this.closed=!0,this.loaded=!1},p.stop=function(){this.video&&(this.video.pause(),this.onVideoEnded())},n(p,"volume",function(){return this.video?this.video.volume:1},function(i){this.video&&(this.video.volume=i)}),n(p,"position",function(){return this.video?this.video.currentTime:0},function(i){this.video&&(this.video.currentTime=i)}),n(p,"bitmapData",function(){return this.video?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=i.web.toBitmapData(this.video)),this._bitmapData):null},void 0),p.onVideoLoaded=function(){this.loaded=!0,this.emitWith(i.Event.COMPLETE)},p.onVideoEnded=function(){this.emitWith(i.Event.ENDED)},p.onVideoError=function(){this.emitWith(i.Event.IO_ERROR)},o}(i.EventEmitter);t.WebVideo=o,i.Video=o}(t=i.web||(i.web={}))}(lark||(lark={}));